/*
                                                                 _ _    
 _ __   __ _  __ _  _____   ____ _ _ __ ___  _ __        ___  __| | | __
| '_ \ / _` |/ _` |/ _ \ \ / / _` | '_ ` _ \| '_ \      / __|/ _` | |/ /
| |_) | (_| | (_| |  __/\ V / (_| | | | | | | |_) |  _  \__ \ (_| |   < 
| .__/ \__,_|\__, |\___| \_/ \__,_|_| |_| |_| .__/  (_) |___/\__,_|_|\_\
|_|          |___/                          |_|                         
┌──────────────────┬────────────────────────────────┐
│ Name             │ Pagevamp SDK                   │
├──────────────────┼────────────────────────────────┤
│ version          │ 0.1.121                        │
├──────────────────┼────────────────────────────────┤
│ Last modified on │ 2014-07-03T21:40:15.355Z       │
├──────────────────┼────────────────────────────────┤
│ Last modified by │ Julien L <julien@pagevamp.com> │
└──────────────────┴────────────────────────────────┘
*/
!function(t){function e(){this.events=new Object,this.offers=new Object,this.retroactiveList={}}e.prototype.subscribe=function(t,e){null==this.events[t]&&(this.events[t]=new Array);var n=Math.round(1e5*Math.random())+"-"+Math.round(1e5*Math.random());return this.events[t].push({callback:e,token:n}),this.retroactiveList[t]&&this.inform(t,this.retroactiveList[t]),n},e.prototype.unsubscribe=function(t){for(var e in this.events)for(var n=0;n<this.events[e].length;n++)if(this.events[e][n].token==t)return this.events[e].splice(n,1),!0;return!1},e.prototype.inform=function(t,e,n){if(n&&(this.retroactiveList[t]=e),null!=this.events[t]){for(var o=0;o<this.events[t].length;o++)this.events[t][o].callback(e);return this.events[t].length}return!1},e.prototype.offer=function(t,e){null==this.offers[t]&&(this.offers[t]=new Object);var n=Math.round(1e5*Math.random())+"-"+Math.round(1e5*Math.random());return this.offers[t]={data:e,token:n},n},e.prototype.request=function(t,e){return null!=e&&e(this.offers[t].data),this.offers[t]?this.offers[t].data:!1},t.Arbiter=new e}(window),function(t,e){meanEngine=function(){this.settings={},this.services={},this.version="beta-2.0",this._cookiePrefix="meanEngine_",this._jsonPrefix="__JSON__",this.components=[],this.componentEditors=[],this.componentInit=!1},meanEngine.prototype.init=function(){},meanEngine.prototype.decodeData=function(e){return e?JSON.parse(t.atob(e)):!1},meanEngine.prototype.registerComponent=function(t){return this.components.push(t),this},meanEngine.prototype.registerEditor=function(t){return this.componentEditors.push(t),this},meanEngine.prototype.initComponents=function(e){if(this.componentInit)return!1;var n,o=this.components.length;for(n=0;o>n;n++)this.components[n](e);var i=this.decodeData(t.pagevampSiteData());if(i&&1==i.edit){var n,o=this.componentEditors.length;for(n=0;o>n;n++)this.componentEditors[n](e)}return this.componentInit=!0,this},meanEngine.prototype.set=function(t,e,n){return this.settings[t]=e,n&&this.setCookie(this._cookiePrefix+t,e,365),this},meanEngine.prototype.unset=function(t){return this.settings[t]&&delete this.settings[t],this.getCookie(this._cookiePrefix+t)&&this.setCookie(this._cookiePrefix+t,null,-1),!0},meanEngine.prototype.get=function(t){return this.settings[t]?this.settings[t]:this.getCookie(this._cookiePrefix+t)?this.getCookie(this._cookiePrefix+t):!1},meanEngine.prototype.service=function(t,e){return e?void(this.services[t]=e()):this.services[t]},meanEngine.prototype.setCookie=function(t,n,o){if("string"!=typeof n&&"number"!=typeof n&&(n=this._jsonPrefix+JSON.stringify(n)),o){var i=new Date;i.setTime(i.getTime()+24*o*60*60*1e3);var r="; expires="+i.toGMTString()}else var r="";return e.cookie=t+"="+n+r+"; path=/;",!0},meanEngine.prototype.getCookie=function(t){for(var n=t+"=",o=e.cookie.split(";"),i=0;i<o.length;i++){for(var r=o[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(n)){var s=r.substring(n.length,r.length);return s.substr(0,this._jsonPrefix.length)==this._jsonPrefix&&(s=JSON.parse(s.substr(this._jsonPrefix.length))),s}}return null},meanEngine.prototype.dom=function(t,n,o){var i=e.createElement(t);return void 0!=n&&$(n).append($(i)),o===!0?i:$(i)},t.meanEngine=new meanEngine}(window,document),function(t){t.set("api",{protocol:"http",hostname:"127.0.0.1",port:5e3}),t.set("site",{data:JSON.parse(window.atob(window.pagevampSiteData())),page:JSON.parse(window.atob(window.pagevampPageData()))})}(window.meanEngine),function(t){var e=function(){this.components=[],this.registeredId={},this.loader={total:0,count:0}};e.prototype.register=function(e){this.components.push(e),this.registeredId[e.id]||(this.registeredId[e.id]={data:e},this.loader.total++,e.editor&&t.get("site").data.edit&&this.loader.total++)},e.prototype.init=function(){var e,n=this;for(e in this.registeredId)!function(e){var o=n.registeredId[e].data.cdnPath+n.registeredId[e].data.directive,i=t.dom("script",$("body"));if(i.attr("src",o),i.bind("load",function(){n.loader.count++;var t=n.loader.count/n.loader.total*100;console.log("Loading...	",t.toFixed(2)+"%"),n.loader.count==n.loader.total&&window.Arbiter.inform("pvsdk.components.loaded",n.components,!0)}),n.registeredId[e].data.editor&&t.get("site").data.edit){var o=n.registeredId[e].data.cdnPath+n.registeredId[e].data.editor,i=t.dom("script",$("body"));i.attr("src",o),i.bind("load",function(){n.loader.count++;var t=n.loader.count/n.loader.total*100;console.log("Loading...	",t.toFixed(2)+"%"),n.loader.count==n.loader.total&&window.Arbiter.inform("pvsdk.components.loaded",n.components,!0)})}}(e)},e.prototype.getComponentById=function(t){return this.registeredId[t]},e.prototype.getCdnPath=function(t){var e=this.getComponentById(t);return e?e.data.cdnPath:!1},e.prototype.getDataFor=function(t){var e=this.getComponentById(t);return e?e.data:!1},e.prototype.getTemplateFor=function(t){var e=this.getComponentById(t);if(!e)return!1;var n=e.data.cdnPath+e.data.template;return"http://127.0.0.1:5000/api/ress/get/raw?path="+window.btoa(n)},e.prototype.getUrlFor=function(t,e){var n=this.getComponentById(e);if(!n)return!1;var o=n.data.cdnPath+t;return"http://127.0.0.1:5000/api/ress/get/raw?path="+window.btoa(o)},t.set("components",new e)}(window.meanEngine),function(t){if("onepage"==t.get("site").data.layout){var e,n,o=[],i=t.get("site").data.pages.length;for(e=0;i>e;e++)for(n=0;n<t.get("site").data.pages[e].components.length;n++)o.push(t.get("site").data.pages[e].components[n])}else var o=t.get("site").page.components;console.warn("Components to load:",o);var e,i=o.length;for(e=0;i>e;e++)t.get("components").register(o[e]);t.get("components").init()}(window.meanEngine),function(t){window.Arbiter.subscribe("pvsdk.components.loaded",function(e){t.set("app",angular.module("main",[])),t.get("app").controller("head",function(e){e.title="Default title",e.theme=t.get("site").data.theme,e.site=t.get("site").data,e.page=t.get("site").page}),t.get("app").controller("body",function(n){n.components=e,n.theme=t.get("site").data.theme,n.site=t.get("site").data,n.page=t.get("site").page}),t.get("app").run(["$rootScope",function(t){t.safeApply=function(t){var e=this.$root.$$phase;"$apply"==e||"$digest"==e?t&&"function"==typeof t&&t():this.$apply(t)}}]),t.initComponents(t.get("app")),angular.bootstrap(document,["main"])})}(window.meanEngine),function(t){t.registerComponent(function(e){e.directive("componentLoader",function(t){var e=function(e,n){console.info("componentLoader",e),e.$watchCollection("page.components",function(){var o=n.html(),i=$(o);if(i.get(0)){var r,s="";for(r=0;r<e.page.components.length;r++)e.page.components[r].link&&e.page.components[r].link!=e.site.theme.id||(s+=o.replace("[component]",'<div pagevamp-component="'+e.page.components[r].id+'" '+e.page.components[r].id+">Loading "+e.page.components[r].name+"... Please wait...</div>"));n.html(t(s)(e))}else{var r,s="";for(r=0;r<e.page.components.length;r++)e.page.components[r].link&&e.page.components[r].link!=e.site.theme.id||(s+='<div pagevamp-component="'+e.page.components[r].id+'" '+e.page.components[r].id+">Loading "+e.page.components[r].name+"... Please wait...</div>");n.html(t(s)(e))}})};return{link:e,scope:!0}}),e.directive("pagevampComponent",function(e){var n=function(n,o){var i=!1,r=function(){i||(i=t.dom("div",$("body")),i.css({position:"absolute",top:$(o).offset().top,left:$(o).offset().left,width:$(o).width(),height:$(o).height(),backgroundColor:"rgba(0,0,0,0.4)","z-index":5e3}),console.log("overlay",i),i.click(function(){o.parent().html(e("<div "+$(o).attr("pagevamp-component")+"editor></div>")(n))}))};console.info("pagevampComponent",n),$(o).hover(function(){console.log("hover"),r()},function(){console.log("out")})};return{link:n,scope:!0}})})}(window.meanEngine);