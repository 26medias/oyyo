/*
                                                                 _ _    
 _ __   __ _  __ _  _____   ____ _ _ __ ___  _ __        ___  __| | | __
| '_ \ / _` |/ _` |/ _ \ \ / / _` | '_ ` _ \| '_ \      / __|/ _` | |/ /
| |_) | (_| | (_| |  __/\ V / (_| | | | | | | |_) |  _  \__ \ (_| |   < 
| .__/ \__,_|\__, |\___| \_/ \__,_|_| |_| |_| .__/  (_) |___/\__,_|_|\_\
|_|          |___/                          |_|                         
┌──────────────────┬────────────────────────────────┐
│ Name             │ Pagevamp SDK                   │
├──────────────────┼────────────────────────────────┤
│ version          │ 0.1.90                         │
├──────────────────┼────────────────────────────────┤
│ Last modified on │ 2014-07-03T20:29:06.986Z       │
├──────────────────┼────────────────────────────────┤
│ Last modified by │ Julien L <julien@pagevamp.com> │
└──────────────────┴────────────────────────────────┘
*/
!function(t){function e(){this.events=new Object,this.offers=new Object,this.retroactiveList={}}e.prototype.subscribe=function(t,e){null==this.events[t]&&(this.events[t]=new Array);var n=Math.round(1e5*Math.random())+"-"+Math.round(1e5*Math.random());return this.events[t].push({callback:e,token:n}),this.retroactiveList[t]&&this.inform(t,this.retroactiveList[t]),n},e.prototype.unsubscribe=function(t){for(var e in this.events)for(var n=0;n<this.events[e].length;n++)if(this.events[e][n].token==t)return this.events[e].splice(n,1),!0;return!1},e.prototype.inform=function(t,e,n){if(n&&(this.retroactiveList[t]=e),null!=this.events[t]){for(var o=0;o<this.events[t].length;o++)this.events[t][o].callback(e);return this.events[t].length}return!1},e.prototype.offer=function(t,e){null==this.offers[t]&&(this.offers[t]=new Object);var n=Math.round(1e5*Math.random())+"-"+Math.round(1e5*Math.random());return this.offers[t]={data:e,token:n},n},e.prototype.request=function(t,e){return null!=e&&e(this.offers[t].data),this.offers[t]?this.offers[t].data:!1},t.Arbiter=new e}(window),function(t){t.set("api",{protocol:"http",hostname:"127.0.0.1",port:5e3}),t.set("site",{data:JSON.parse(window.atob(window.pagevampSiteData())),page:JSON.parse(window.atob(window.pagevampPageData()))})}(window.meanEngine),function(t){var e=function(){this.components=[],this.registeredId={},this.loader={total:0,count:0}};e.prototype.register=function(t){this.components.push(t),this.registeredId[t.id]||(this.registeredId[t.id]={data:t},this.loader.total++)},e.prototype.init=function(){var e,n=this;for(e in this.registeredId)!function(e){var o=n.registeredId[e].data.cdnPath+n.registeredId[e].data.directive,a=t.dom("script",$("body"));a.attr("src",o),a.bind("load",function(){n.loader.count++;var t=n.loader.count/n.loader.total*100;console.log("Loading...	",t.toFixed(2)+"%"),n.loader.count==n.loader.total&&window.Arbiter.inform("pvsdk.components.loaded",n.components,!0)})}(e)},e.prototype.getComponentById=function(t){return this.registeredId[t]},e.prototype.getCdnPath=function(t){var e=this.getComponentById(t);return e?e.data.cdnPath:!1},e.prototype.getDataFor=function(t){var e=this.getComponentById(t);return e?e.data:!1},e.prototype.getTemplateFor=function(t){var e=this.getComponentById(t);if(!e)return!1;var n=e.data.cdnPath+e.data.template;return"http://127.0.0.1:5000/api/ress/get/raw?path="+window.btoa(n)},e.prototype.getUrlFor=function(t,e){var n=this.getComponentById(e);if(!n)return!1;var o=n.data.cdnPath+t;return"http://127.0.0.1:5000/api/ress/get/raw?path="+window.btoa(o)},t.set("components",new e)}(window.meanEngine),function(t){if("onepage"==t.get("site").data.layout){var e,n,o=[],a=t.get("site").data.pages.length;for(e=0;a>e;e++)for(n=0;n<t.get("site").data.pages[e].components.length;n++)o.push(t.get("site").data.pages[e].components[n])}else var o=t.get("site").page.components;console.warn("components for this page:",o);var e,a=o.length;for(e=0;a>e;e++)t.get("components").register(o[e]);t.get("components").init()}(window.meanEngine),function(t){window.Arbiter.subscribe("pvsdk.components.loaded",function(e){t.set("app",angular.module("main",[])),t.get("app").controller("head",function(e){e.title="Default title",e.theme=t.get("site").data.theme,e.site=t.get("site").data,e.page=t.get("site").page}),t.get("app").controller("body",function(n){n.components=e,n.theme=t.get("site").data.theme,n.site=t.get("site").data,n.page=t.get("site").page}),t.get("app").run(["$rootScope",function(t){t.safeApply=function(t){var e=this.$root.$$phase;"$apply"==e||"$digest"==e?t&&"function"==typeof t&&t():this.$apply(t)}}]),t.initComponents(t.get("app")),angular.bootstrap(document,["main"])})}(window.meanEngine),function(t){t.registerComponent(function(t){t.directive("componentLoader",function(t){var e=function(e,n){console.info("componentLoader",e),e.$watchCollection("page.components",function(){var o=n.html(),a=$(o);if(a.get(0)){var i,r="";for(i=0;i<e.page.components.length;i++)e.page.components[i].link&&e.page.components[i].link!=e.site.theme.id||(r+=o.replace("[component]","<div "+e.page.components[i].id+">Loading "+e.page.components[i].name+"... Please wait...</div>"));n.html(t(r)(e))}else{var i,r="";for(i=0;i<e.page.components.length;i++)e.page.components[i].link&&e.page.components[i].link!=e.site.theme.id||(r+="<div "+e.page.components[i].id+">Loading "+e.page.components[i].name+"... Please wait...</div>");n.html(t(r)(e))}})};return{link:e,scope:!0}})})}(window.meanEngine);